inline double dot(const vec&a, const vec& b){
  return a.dot(b);
}