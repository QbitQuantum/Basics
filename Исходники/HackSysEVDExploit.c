BOOL IsProcessHavingHigherPrivilege(LPCSTR TargetProcess) {
    DWORD ProcessID = 0;
    HANDLE hProcess = NULL;
    BOOL IsHighPrivileged = FALSE;

    DEBUG_MESSAGE("\t[+] Trying To Get Process ID Of: %s\n", TargetProcess);

    ProcessID = GetProcessID(TargetProcess);

    if (!ProcessID) {
        DEBUG_ERROR("\t\t[-] Failed To Get Process ID Of: %s\n", TargetProcess);
        exit(EXIT_FAILURE);
    }
    else {
        DEBUG_INFO("\t\t[+] Process ID Of %s: %d\n", TargetProcess, ProcessID);
    }

    DEBUG_MESSAGE("\t[+] Trying To Open %s With PROCESS_ALL_ACCESS\n", TargetProcess);

    // Open the process to check the privilege level, if we are able
    // to open any SYSTEM process, this means we have successfully
    // elevated current process privileges
    hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, ProcessID);

    if (!hProcess) {
        DEBUG_ERROR("\t\t[-] Failed To Open %s Process: 0x%X\n", TargetProcess, GetLastError());
    }
    else {
        DEBUG_INFO("\t\t[+] Process Handle Of %s: 0x%X\n", TargetProcess, hProcess);
        IsHighPrivileged = TRUE;
    }

    return IsHighPrivileged;
}